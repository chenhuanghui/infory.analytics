<div ng-include="'partials/_header.html'"></div>
<div ng-include="'partials/_sidebar.html'"></div>
<!-- main container -->
<div id="notify-new" class="content">
    <div id="notify-fuelux-wizard" class="wizard">
        <ul class="wizard-steps">
            <li data-target="#notify-step1">
                <span class="z-step">Soạn tin</span><img class="line-step" src="img/line_step.png" />
            </li>
            <li data-target="#notify-step2" class="active">
                <span class="z-step">Đối tượng</span><img class="line-step" src="img/line_step.png" />
            </li>
            <li data-target="#notify-step3">
                <span class="z-step">Kích hoạt</span><img class="line-step" src="img/line_step.png" />
            </li>
            <li data-target="#notify-step4" id="menu-manager" onclick="showManager('#menu-manager', '#notify-step4')">
                <span class="z-step">Quản lý tin</span>
            </li>
        </ul>                            
    </div>
    <div id="notify-step-content" class="step-content form-page">
        <div class="step-pane active" id="notify-step2">
            <div class="step-description">
                <div class="step-title">
                    <span class="step-name">Bước 2:</span> Chọn lọc khách hàng trong danh sách
                </div>
                Tạo hệ thống tin tức mới từ dịch vụ cũng như những chiến dịch của bạn dễ dàng theo dạng danh sách và thao tác đợn giản
            </div>
            
            <div class="wapper">
                <div class="block">
                    <div class="block_header">
                        <div class="left control">
                            Lọc danh sách khách hàng theo
                        </div>
                        <div class="right">
                            <div class="controller" ng-hide="true">
                                <div class="z-dropdown-wapper">
                                <div class="z-dropdown">
                                    <a class="trigger"><span>{{profileBookmark.bookmark_name}}</span></a>
                                    <ul>
                                        <li ng-repeat="profileBookmark in profileBookmarks"><a ng-click="changeProfileBookmark(profileBookmark.id)" style="cursor:pointer">{{profileBookmark.bookmark_name}}</a></li>
                                        
                                        <li class="create-box">
                                            <i class="icon-plus"></i>
                                            <input type="text" placeholder="new category" ng-model="newCategoryName"/>
                                            <input type="button" value="CREATE CATEGORY" ng-click="createProfile(newCategoryName)"/>
                                        </li>
                                    </ul>
                                </div>
                                <i class="icon-sort-down"></i>
                            </div>
                            <span class="btn-glow success _large" ng-click="updateDataProfile()"><i class="icon-bookmark-empty"></i>Lưu</span>
                                <!-- <select ng-model="event" ng-options="event as event.name_display for event in events" ng-init="event=events[0]"></select>
                                <span class="btn-glow success"><i class="icon-bookmark-empty"></i> Lưu</span> -->
                            </div>
                        </div>
                    </div>
                    <div class="block_content">
                        <p class="notify"> Danh sách khách hàng nhận thông báo <span>{{event.name_display}}</span> thoả điều kiện</p>
                        <div smg-filter metas="metas" events="events" metadata="metadata" event="event" subfilters="subfilters" oldsubfilters="oldsubfilters"></div>
                    </div>
                    <div class="block_footer">
                        <div class="left method">
                            Phương thức  <select ng-model="sendMethod" ng-options="sendMethod as sendMethod.name_display for sendMethod in sendMethods" ng-change="updateIsCanGo()"></select>
                        </div>
                        <button ng-hide="sendMethod.name == 'auto'" ng-click="getResult()" type="button" class="btn-glow primary right"><i class="icon-ok"></i> Xem</button>
                    </div><!-- block footer-->
                </div><!-- block -->
                
                <div class="block" ng-hide="sendMethod.name == 'auto'">
                    <div class="block_header">
                        <div class="left control">
                            <span class="highlight">{{numOfSelectedUsers}}</span> khách hàng được chọn / <span class="highlight">{{isChecked.length}}</span> khách hàng thoả điều kiện
                        </div>
                        <input type="text" class="search right" placeholder="Tìm kiếm..." ng-model="searchText" ng-change="filterUser()"/>
                        <div class="fee right">
                            Chi phí: <span>{{numOfSelectedUsers * 10}}</span> T-coin
                        </div>
                    </div>
                    <div ng-hide="hideLoading" class="loading-container-image-product">
                        <div title="Code: 0xe800" class="the-icons span3"><i class="icon-fontello-spin6 animate-spin loading-product-image loading-icon"></i></div>
                    </div>
                    
                    <div class="block_content no-padding" ng-hide="!hideLoading">
                        <table class="z-table">
                        <thead>
                            <tr>
                                <th><input type="checkbox" ng-model="all" ng-change="checkAll(); updateIsCanGo();"/></th>
                                <th class = "name">
                                    Số điện thoại
                                </th>
                                <th class="name">Tên</th>
                                <th>Tuổi</th>
                                <th>Giới tính</th>
                                <th>Vị trí</th>
                                <th>Lần sử dụng cuối</th>
                            </tr>
                        </thead>
                        <tbody ng-repeat="user in dataInCurrentPage">
                            <tr>
                                <td><input type="checkbox" ng-model="$parent.isChecked[user.stt]" ng-change="updateSelectedUsers($parent.isChecked[user.stt]); updateIsCanGo();"/></td>
                                <td style="cursor:pointer" ng-click="showUserProfile(user.id)">{{user.phone}}</td>
                                <td class="name"  style="cursor:pointer" ng-click="showUserProfile(user.id)">{{user.name}}</td>
                                <td style="cursor:pointer" ng-click="showUserProfile(user.id)">{{user.dob}}</td>
                                <td style="cursor:pointer" ng-click="showUserProfile(user.id)">{{user.gender}}</td>
                                <td style="cursor:pointer" ng-click="showUserProfile(user.id)">{{user.city}}</td>
                                <td style="cursor:pointer" ng-click="showUserProfile(user.id)">{{user.last_visit}}</td>
                            </tr>
                        </tbody>
                        
                    </table>
                        <spagination ng-hide="dataInCurrentPage.length == 0" class="right" total-items="totalItems" page="currentPage" on-select-page="pageChanged(page)" items-per-page="itemsPerPage" boundary-links="false" rotate="false" first-text="Đầu tiên" last-text="Cuối cùng" next-text="Sau" previous-text="Trước" max-size="10" style="width: 485px;"></spagination>
                        <!--chart here-->
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-8 with-sidebar">
        <div class="col-md-11">
            <div class="notify-wizard-actions wizard-actions">
                <button type="button" class="btn-glow primary btn-prev" ng-click="goToStep1()"> 
                    <i class="icon-chevron-left"></i> Trở lại
                </button>
                <button type="button" class="btn-glow primary btn-next" ng-click="goToStep3()" ng-disabled="!isCanGo">
                    Tiếp tục <i class="icon-chevron-right"></i>
                </button>
            </div>
        </div>
    </div>
</div>
<!-- scripts -->
<script src="vendor/theme/scripts/jquery-ui-1.10.2.custom.min.js"></script>
<script src="vendor/theme/scripts/fuelux.wizard.js"></script>
<script src="vendor/theme/scripts/tinymce/tinymce.min.js"></script>
<script src="vendor/theme/scripts/tinymce/themes/modern/theme.min.js"></script>